{
  "target": "tests\\samples\\vulnerable_code.py",
  "scan_time": "2026-02-11T15:00:03.020815",
  "duration": 0.017345190048217773,
  "files_scanned": 1,
  "summary": {
    "total": 30,
    "critical": 6,
    "high": 20,
    "medium": 4,
    "low": 0,
    "ignored": 0,
    "filtered": 0
  },
  "vulnerabilities": [
    {
      "rule_id": "SQL001",
      "rule_name": "SQL注入风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 21,
      "column": 12,
      "code_snippet": "query = \"SELECT * FROM users WHERE id = '%s'\" % user_id",
      "description": "使用 % 格式化拼接SQL语句，存在SQL注入风险",
      "suggestion": "使用参数化查询（如 cursor.execute(sql, params)）代替字符串拼接，或使用ORM框架进行数据库操作",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SQL001",
      "rule_name": "SQL注入风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 31,
      "column": 12,
      "code_snippet": "query = f\"SELECT * FROM users WHERE username = '{username}'\"",
      "description": "使用 f-string 拼接SQL语句，存在SQL注入风险",
      "suggestion": "使用参数化查询（如 cursor.execute(sql, params)）代替字符串拼接，或使用ORM框架进行数据库操作",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SQL001",
      "rule_name": "SQL注入风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 41,
      "column": 12,
      "code_snippet": "query = \"SELECT * FROM \" + table_name + \" WHERE active = 1\"",
      "description": "使用 + 连接拼接SQL语句，存在SQL注入风险",
      "suggestion": "使用参数化查询（如 cursor.execute(sql, params)）代替字符串拼接，或使用ORM框架进行数据库操作",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SQL001",
      "rule_name": "SQL注入风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 41,
      "column": 12,
      "code_snippet": "query = \"SELECT * FROM \" + table_name + \" WHERE active = 1\"",
      "description": "使用 + 连接拼接SQL语句，存在SQL注入风险",
      "suggestion": "使用参数化查询（如 cursor.execute(sql, params)）代替字符串拼接，或使用ORM框架进行数据库操作",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "CMD001",
      "rule_name": "命令注入风险",
      "severity": "critical",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 52,
      "column": 4,
      "code_snippet": "os.system(\"ping \" + user_input)",
      "description": "调用危险函数 os.system(): 直接执行shell命令",
      "suggestion": "避免执行外部命令；如必须执行，使用参数列表形式并严格校验输入",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "CMD001",
      "rule_name": "命令注入风险",
      "severity": "critical",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 58,
      "column": 13,
      "code_snippet": "result = subprocess.run(cmd, shell=True, capture_output=True)",
      "description": "调用 subprocess.run() 时使用 shell=True，存在命令注入风险",
      "suggestion": "避免使用 shell=True；使用参数列表传递命令；对用户输入进行严格校验",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "CMD001",
      "rule_name": "命令注入风险",
      "severity": "critical",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 65,
      "column": 13,
      "code_snippet": "output = os.popen(f\"cat {filename}\").read()",
      "description": "调用危险函数 os.popen(): 执行命令并返回文件对象",
      "suggestion": "避免执行外部命令；如必须执行，使用参数列表形式并严格校验输入",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SEC001",
      "rule_name": "硬编码敏感信息",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 72,
      "column": 0,
      "code_snippet": "DATABASE_PASSWORD = \"super_secret_password_123\"",
      "description": "变量 'DATABASE_PASSWORD' 包含硬编码的敏感信息，可能导致凭据泄露",
      "suggestion": "使用环境变量存储敏感信息，如 os.environ.get('SECRET_KEY')；或使用配置文件（不提交到版本控制）；或使用密钥管理服务",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SEC001",
      "rule_name": "硬编码敏感信息",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 73,
      "column": 0,
      "code_snippet": "API_KEY = \"sk-1234567890abcdef\"",
      "description": "变量 'API_KEY' 包含硬编码的敏感信息，可能导致凭据泄露",
      "suggestion": "使用环境变量存储敏感信息，如 os.environ.get('SECRET_KEY')；或使用配置文件（不提交到版本控制）；或使用密钥管理服务",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SEC001",
      "rule_name": "硬编码敏感信息",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 74,
      "column": 0,
      "code_snippet": "SECRET_TOKEN = \"ghp_xxxxxxxxxxxxxxxxxxxx\"",
      "description": "变量 'SECRET_TOKEN' 包含硬编码的敏感信息，可能导致凭据泄露",
      "suggestion": "使用环境变量存储敏感信息，如 os.environ.get('SECRET_KEY')；或使用配置文件（不提交到版本控制）；或使用密钥管理服务",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SEC001",
      "rule_name": "硬编码敏感信息",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 79,
      "column": 4,
      "code_snippet": "password = \"mysql_password_2024\"  # 危险：硬编码密码",
      "description": "变量 'password' 包含硬编码的敏感信息，可能导致凭据泄露",
      "suggestion": "使用环境变量存储敏感信息，如 os.environ.get('SECRET_KEY')；或使用配置文件（不提交到版本控制）；或使用密钥管理服务",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SEC001",
      "rule_name": "硬编码敏感信息",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 85,
      "column": 4,
      "code_snippet": "secret = \"aws_secret_access_key_xxxxx\"  # 危险",
      "description": "变量 'secret' 包含硬编码的敏感信息，可能导致凭据泄露",
      "suggestion": "使用环境变量存储敏感信息，如 os.environ.get('SECRET_KEY')；或使用配置文件（不提交到版本控制）；或使用密钥管理服务",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "DNG001",
      "rule_name": "危险函数调用",
      "severity": "critical",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 95,
      "column": 13,
      "code_snippet": "result = eval(user_expr)",
      "description": "调用危险函数 eval(): 执行任意Python表达式，可导致远程代码执行",
      "suggestion": "避免使用eval；如需解析字面量，使用ast.literal_eval",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "DNG001",
      "rule_name": "危险函数调用",
      "severity": "critical",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 102,
      "column": 4,
      "code_snippet": "exec(user_code)",
      "description": "调用危险函数 exec(): 执行任意Python代码，可导致远程代码执行",
      "suggestion": "避免使用exec；重新设计程序逻辑避免动态代码执行",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "DNG001",
      "rule_name": "危险函数调用",
      "severity": "critical",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 108,
      "column": 10,
      "code_snippet": "obj = pickle.loads(data)",
      "description": "调用危险方法 pickle.loads(): 反序列化不可信数据可导致远程代码执行",
      "suggestion": "避免反序列化不可信数据；使用json等安全格式",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "DNG001",
      "rule_name": "危险函数调用",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 115,
      "column": 11,
      "code_snippet": "data = yaml.load(yaml_content)",
      "description": "调用危险方法 yaml.load(): 不安全的YAML解析，可执行任意Python代码",
      "suggestion": "使用yaml.safe_load代替yaml.load",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "PTH001",
      "rule_name": "路径遍历风险",
      "severity": "medium",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 132,
      "column": 16,
      "code_snippet": "file_path = os.path.join(base_dir, user_path)",
      "description": "os.path.join() 的参数可能来自用户输入，如果包含 '../' 可导致路径遍历",
      "suggestion": "在拼接前使用os.path.basename()清理用户输入；拼接后使用os.path.realpath()验证最终路径是否在允许的目录内",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "PTH001",
      "rule_name": "路径遍历风险",
      "severity": "medium",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 125,
      "column": 9,
      "code_snippet": "with open(filename, \"r\") as f:",
      "description": "调用 open() 的路径参数可能来自用户输入，存在路径遍历风险",
      "suggestion": "对文件路径进行严格校验；使用os.path.basename()提取文件名；使用os.path.realpath()解析真实路径后验证是否在允许的目录内",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "PTH001",
      "rule_name": "路径遍历风险",
      "severity": "medium",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 140,
      "column": 9,
      "code_snippet": "with open(f\"/uploads/{filename}\", \"rb\") as f:",
      "description": "调用 open() 的路径参数可能来自用户输入，存在路径遍历风险",
      "suggestion": "对文件路径进行严格校验；使用os.path.basename()提取文件名；使用os.path.realpath()解析真实路径后验证是否在允许的目录内",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "PTH001",
      "rule_name": "路径遍历风险",
      "severity": "medium",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 133,
      "column": 11,
      "code_snippet": "return open(file_path, \"r\").read()",
      "description": "调用 open() 的路径参数可能来自用户输入，存在路径遍历风险",
      "suggestion": "对文件路径进行严格校验；使用os.path.basename()提取文件名；使用os.path.realpath()解析真实路径后验证是否在允许的目录内",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "XSS001",
      "rule_name": "XSS风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 151,
      "column": 11,
      "code_snippet": "return render_template_string(template)",
      "description": "调用 render_template_string() 渲染包含用户输入的模板，存在XSS风险",
      "suggestion": "使用 render_template() 渲染模板文件而非字符串；确保对用户输入进行HTML转义；使用模板引擎的自动转义功能",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "XSS001",
      "rule_name": "XSS风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 157,
      "column": 11,
      "code_snippet": "return mark_safe(f\"<div>{user_content}</div>\")",
      "description": "调用 mark_safe() 将包含用户输入的内容标记为安全，存在XSS风险",
      "suggestion": "永远不要将用户输入直接标记为安全；使用 format_html() 或手动转义后再标记",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SSRF001",
      "rule_name": "SSRF服务端请求伪造风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 194,
      "column": 15,
      "code_snippet": "response = requests.get(url)",
      "description": "requests.get() 的URL参数可能来自用户输入，存在SSRF风险",
      "suggestion": "建议对URL进行白名单验证，只允许访问可信的域名。可使用 urllib.parse 解析URL并验证域名。",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SSRF001",
      "rule_name": "SSRF服务端请求伪造风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 203,
      "column": 15,
      "code_snippet": "response = requests.post(user_url, data={\"key\": \"value\"})",
      "description": "requests.post() 的URL参数可能来自用户输入，存在SSRF风险",
      "suggestion": "建议对URL进行白名单验证，只允许访问可信的域名。可使用 urllib.parse 解析URL并验证域名。",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SSRF001",
      "rule_name": "SSRF服务端请求伪造风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 212,
      "column": 15,
      "code_snippet": "response = urllib.request.urlopen(target_url)",
      "description": "urllib.request.urlopen() 的URL参数可能来自用户输入，存在SSRF风险",
      "suggestion": "建议对URL进行白名单验证，只允许访问可信的域名。可使用 urllib.parse 解析URL并验证域名。",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "SSRF001",
      "rule_name": "SSRF服务端请求伪造风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 221,
      "column": 15,
      "code_snippet": "response = urlopen(url)",
      "description": "urllib.request.urlopen() 的URL参数可能来自用户输入，存在SSRF风险",
      "suggestion": "建议对URL进行白名单验证，只允许访问可信的域名。可使用 urllib.parse 解析URL并验证域名。",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "XXE001",
      "rule_name": "XML外部实体注入风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 233,
      "column": 11,
      "code_snippet": "tree = ET.parse(xml_file)",
      "description": "使用 xml.etree.ElementTree.parse() 解析XML，默认配置存在XXE风险",
      "suggestion": "建议使用 defusedxml 库代替标准库解析XML。例如: import defusedxml.ElementTree as ET",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "XXE001",
      "rule_name": "XML外部实体注入风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 242,
      "column": 10,
      "code_snippet": "doc = etree.fromstring(xml_content)",
      "description": "使用 xml.etree.ElementTree.fromstring() 解析XML，默认配置存在XXE风险",
      "suggestion": "建议使用 defusedxml 库代替标准库解析XML。例如: import defusedxml.ElementTree as ET",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "XXE001",
      "rule_name": "XML外部实体注入风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 251,
      "column": 4,
      "code_snippet": "xml.sax.parse(xml_file, xml.sax.ContentHandler())",
      "description": "使用 xml.sax.parse() 解析XML，默认配置存在XXE风险",
      "suggestion": "建议使用 defusedxml.sax 代替标准库。例如: from defusedxml import sax",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    },
    {
      "rule_id": "FLK004",
      "rule_name": "Flask Jinja2 模板注入风险",
      "severity": "high",
      "file_path": "D:\\EduLibrary\\OurEDA\\oss-2025\\python-security-scanner\\tests\\samples\\vulnerable_code.py",
      "line_number": 151,
      "column": 11,
      "code_snippet": "return render_template_string(template)",
      "description": "使用 render_template_string() 渲染动态模板内容，可能导致 SSTI 攻击",
      "suggestion": "避免使用 render_template_string() 渲染用户输入；使用模板文件和自动转义",
      "fix_example": "",
      "fix_code": null,
      "auto_fixable": false,
      "fix_risk": "high"
    }
  ],
  "errors": []
}